<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!--NewPage-->
<html>
<head>
<!-- Generated by cdoc on Wed Jan 26 05:45:09 2005 -->
<title>
file libsrc/libtime/timeParse.c
</title>
</head>
<body>
<a name="_top_"></a><pre>
<a href="directories.html">All directories</a>  <a href="libsrc_libtime.html">This Directory</a>  <a href="libsrc_libtime.html#_top_">Previous</a>  <a href="libsrc_libtime_timeUtil.c.html#_top_">Next</a>  <a href="AllNames.html">Index</a></pre>
<hr>
<h1>
File libsrc/libtime/timeParse.c
</h1>
<hr>
<!End-Header> Some basic time parsing and formatting routines.
<hr>
<h2>
Public Function Index
</h2>
<dl>
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#timeCheckTimes"><b>timeCheckTimes</b></a> (double, double, char *, int)
<dd> Check time limits.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#timeEpochToString"><b>timeEpochToString</b></a> (double, char *, int, enum TimeFormat)
<dd> Print a date and time.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#timeParseLine"><b>timeParseLine</b></a> (const char *, int, int, void *, int, const char *)
<dd> Parse a character string for date and time values.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#timeParseString"><b>timeParseString</b></a> (const char *, double *)
<dd> Parse a string for a time expression.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#timeStringToEpoch"><b>timeStringToEpoch</b></a> (const char *, enum TimeFormat)
<dd> Parse a string using the input TimeFormat code.
</dl>
<h2>
Public Functions
</h2>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="timeCheckTimes"><b>timeCheckTimes</b></a>
<pre>
 int timeCheckTimes(double time1,
                    double time2,
                    char *msg,
                    int len)
</pre>
<dl>
<dd>  Check time limits. Check that the time values are a valid time period.
  Returns 1 if time1 and time2 are > NULL_TIME_CHECK and time2 > time1 and
  fabs(time2 - time1) >= 0.001. Otherwise, returns 0 and prints an error
  message in msg.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="timeEpochToString"><b>timeEpochToString</b></a>
<pre>
 char *timeEpochToString(double epoch,
                         char *str,
                         int len,
                         enum TimeFormat format)
</pre>
<dl>
<dd>  Print a date and time. Print the data and time that an epochal double
  represents, using the input TimeFormat. The TimeFormat codes are:
  <pre>
 
    code               format                           args
 
  YMONDHMS     "%04d%s%02d %02d:%02d:%06.3f"      yr,mname,day,hr,min,sec
  YMONDHMS2    "%04d%s%02d %02d:%02d:%04.1f"      yr,mname,day,hr,min,sec
  YMONDHMS3    "%04d%s%02d %02d:%02d:%02.0f"      yr,mname,day,hr,min,sec
  YMOND        "%04d%s%02d"                       yr,mname,day
  HMS          "%02d:%02d:%06.3f"                 hr,min,sec
  HMS2         "%02d:%02d:%04.1f"                 hr,min,sec
  GSE20        "%04d/%02d/%02d %02d:%02d:%04.1f"  yr,mon,day,hr,min,sec
  GSE21        "%04d/%02d/%02d %02d:%02d:%06.3f"  yr,mon,day,hr,min,sec
  MONTH_HOURS  "%03d:%02d:%06.3f"                 epoch_hours,min,sec
  MONTH_HOURS2 "%03d:%02d:%02.0f"                 epoch_hours,min,sec
  YMD          "%04d-%02d-%02d"                   yr,mon,day
  DHMS         "%03d %02d:%02d:%02.0f"            day-1,hr,min,sec
  EPOCH_DAYS   "%03d %02d:%02d:%02.0f"            epoch_days,hr,min,sec
  EPOCH_DAYS2  "%03d %02d:%02d:%04.1f"            epoch_days,hr,min,sec
  </pre>

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> epoch - The epochal time to print. If epoch is <= NULL_TIME_CHECK, the  string str will be set to "none".

<dd> str - A string to hold the printed date/time.

<dd> len - The size of <b>str</b>.

<dd> format - One of the format codes above.

<dt> <b>Returns:</b>
<dd> str

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="timeParseLine"><b>timeParseLine</b></a>
<pre>
 void timeParseLine(const char *line,
                    int s_pos,
                    int e_pos,
                    void *val,
                    int size,
                    const char *type)
</pre>
<dl>
<dd>  Parse a character string for date and time values. This routine is called
  recursively to parse the input string. The parse type can be:
  <pre>
 
  "f"                          float value
  "lf"                         double value
  "d"                          int value
  "ld"                         long value
  "s"                          string value
  "S"                          string value skip blanks
  "yymmdd_hhmmss"              date time
  "yyyymmdd_hhmmssss"          date time
  "yyyymmdd_hhmmssssss"        date time
  "yyyymmdd_hhmmssssssss"      date time
  "hhmmss"                     time


<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> line - The string to parse between s_pos and e_pos.

<dd> s_pos - The starting index of line.

<dd> e_pos - The ending index of line.

<dd> val - A pointer to a memory location of length size bytes.

<dd> size - The length (number of bytes) of val. For strings, size must be  >= e_pos - s_pos + 2.

<dd> type - The parse type.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="timeParseString"><b>timeParseString</b></a>
<pre>
 int timeParseString(const char *string,
                     double *time)
</pre>
<dl>
<dd>  Parse a string for a time expression. Return the time as the epochal time,
  seconds since 1970/1/1. Valid expressions start with either "now" or
  a time in one of the many formats shown below. The expression can also
  have additional terms of relative time to be added or subtracted from the
  first time. Acceptable formats for the relative-time terms include
  key words and abbreviations for time units:
  <pre>
  For years: "years" "year" "yrs" "yr" "y"
 
  For months: "months" "month" "mon" 
 
  For weeks: "weeks" "week" "w"
 
  For days: "days" "day" "d"
 
  For hours: "hours" "hrs" "hr" "h"
 
  For minutes: "minutes" "minute" "min" "mn" "m"
 
  For seconds: "seconds" "second" "secs" "sec" "sc" "s"
  </pre>
  Examples:
  <pre>
      now - 3d - 2h
      now + 1.5d
      1993/8/14 12:32 - 2hrs
      1997/03/12  12:23:39.7
      97464643.
      97464643. + 5s + 1h
      2003Jan25 12:23:39.7
      1995/123  12:23:39.7
      2001-11-12 18:31:01
  </pre>
  <p>
  timeParseString recognizes string in the following strftime/strptime time
  formats:
  <pre>
 
       strftime format             example
 
      "%y%b%d%n%H:%M:%S"       03Jan25 hh:mm:ss
      "%y%b%d%n%H %M %S"       03Jan25 hh mm ss
      "%y-%b-%d%n%H:%M:%S"     03-Jan-25 hh:mm:ss
      "%y-%b-%d%n%H %M %S"     03-Jan-25 hh mm ss
      "%y/%b/%d%n%H:%M:%S"     03/Jan/25 hh:mm:ss
      "%y/%b/%d%n%H %M %S"     03/Jan/25 hh mm ss
      "%Y%b%d%n%H:%M:%S"       2003Jan25 hh:mm:ss
      "%Y%b%d%n%H %M %S"       2003Jan25 hh mm ss
      "%Y-%b-%d%n%H:%M:%S"     2003-Jan-25 hh:mm:ss
      "%Y-%b-%d%n%H %M %S"     2003-Jan-25 hh mm ss
      "%Y/%b/%d%n%H:%M:%S"     2003/Jan/25 hh:mm:ss
      "%Y/%b/%d%n%H %M %S"     2003/Jan/25 hh mm ss
      "%Y-%m-%d%n%H:%M:%S"     2003-01-25 hh:mm:ss
      "%Y-%m-%d%n%H %M %S"     2003-01-25 hh mm ss
      "%Y/%m/%d%n%H:%M:%S"     2003/01/25 hh:mm:ss
      "%Y/%m/%d%n%H %M %S"     2003/01/25 hh mm ss
      "%y-%m-%d%n%H:%M:%S"     03-01-25 hh:mm:ss
      "%y-%m-%d%n%H %M %S"     03-01-25 hh mm ss
      "%y/%m/%d%n%H:%M:%S"     03/01/25 hh:mm:ss
      "%y/%m/%d%n%H %M %S"     03/01/25 hh mm ss
      
      "%y%b%d%n%H:%M"          03Jan25 hh:mm
      "%y%b%d%n%H %M"          03Jan25 hh mm
      "%y-%b-%d%n%H:%M"        03-Jan-25 hh:mm
      "%y-%b-%d%n%H %M"        03-Jan-25 hh mm
      "%y/%b/%d%n%H:%M"        03/Jan/25 hh:mm
      "%y/%b/%d%n%H %M"        03/Jan/25 hh mm
      "%Y%b%d%n%H:%M"          2003Jan25 hh:mm
      "%Y%b%d%n%H %M"          2003Jan25 hh mm
      "%Y-%b-%d%n%H:%M"        2003-Jan-25 hh:mm
      "%Y-%b-%d%n%H %M"        2003-Jan-25 hh mm
      "%Y/%b/%d%n%H:%M"        2003/Jan/25 hh:mm
      "%Y/%b/%d%n%H %M"        2003/Jan/25 hh mm
      "%Y-%m-%d%n%H:%M"        2003-01-25 hh:mm
      "%Y-%m-%d%n%H %M"        2003-01-25 hh mm
      "%Y/%m/%d%n%H:%M"        2003/01/25 hh:mm
      "%Y/%m/%d%n%H %M"        2003/01/25 hh mm
      "%y-%m-%d%n%H:%M"        03-01-25 hh:mm
      "%y-%m-%d%n%H %M"        03-01-25 hh mm
      "%y/%m/%d%n%H:%M"        03/01/25 hh:mm
      "%y/%m/%d%n%H %M"        03/01/25 hh mm
      
      "%y%b%d%n%H"             03Jan25 hh
      "%y-%b-%d%n%H"           03-Jan-25 hh
      "%y/%b/%d%n%H"           03/Jan/25 hh
      "%Y%b%d%n%H"             2003Jan25 hh
      "%Y-%b-%d%n%H"           2003-Jan-25 hh
      "%Y/%b/%d%n%H"           2003/Jan/25 hh
      "%Y-%m-%d%n%H"           2003-01-25 hh
      "%Y/%m/%d%n%H"           2003/01/25 hh
      "%y-%m-%d%n%H"           03-01-25 hh
      "%y/%m/%d%n%H"           03/01/25 hh
      
      "%y%b%d"                 03Jan25
      "%d-%b-%Y"               25-Jan-2003
      "%y-%b-%d"               03-Jan-25
      "%y/%b/%d"               03/Jan/25
      "%Y%b%d"                 2003Jan25
      "%Y-%b-%d"               2003-Jan-25
      "%Y/%b/%d"               2003/Jan/25
      "%Y-%m-%d"               2003-01-25
      "%Y/%m/%d"               2003/01/25
      "%y-%m-%d"               03-01-25
      "%y/%m/%d"               03/01/25
      
      "%y%b"                   03Jan
      "%y-%b"                  03-Jan
      "%y/%b"                  03/Jan
      "%Y%b"                   2003Jan
      "%Y-%b"                  2003-Jan
      "%Y/%b"                  2003/Jan
      
      "%Y/%j%n%H:%M:%S"        2003/123 hh:mm:ss
      "%Y/%j%n%H %M %S"        2003/123 hh mm ss
      "%Y/%j%n%H:%M"           2003/123 hh:mm
      "%Y/%j%n%H %M"           2003/123 hh mm
      "%Y/%j%n%H"              2003/123 hh
      "%Y/%j"                  2003/123
  </pre>

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> string - The string time expression.

<dd> time - The epochal time returned.

<dt> <b>Returns:</b>
<dd> 1 for success, 0 for failure to parse.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="timeStringToEpoch"><b>timeStringToEpoch</b></a>
<pre>
 double timeStringToEpoch(const char *str,
                          enum TimeFormat format)
</pre>
<dl>
<dd>   Parse a string using the input TimeFormat code. Returns NULL_TIME if the
   string cannot be parsed. The TimeFormat codes are:
  <pre>
 
    code               format                           args
 
  YMONDHMS     "%04d%s%02d %02d:%02d:%06.3f"      yr,mname,day,hr,min,sec
  YMONDHMS2    "%04d%s%02d %02d:%02d:%04.1f"      yr,mname,day,hr,min,sec
  YMONDHMS3    "%04d%s%02d %02d:%02d:%02.0f"      yr,mname,day,hr,min,sec
  YMOND        "%04d%s%02d"                       yr,mname,day
  HMS          "%02d:%02d:%06.3f"                 hr,min,sec
  HMS2         "%02d:%02d:%04.1f"                 hr,min,sec
  GSE20        "%04d/%02d/%02d %02d:%02d:%04.1f"  yr,mon,day,hr,min,sec
  GSE21        "%04d/%02d/%02d %02d:%02d:%06.3f"  yr,mon,day,hr,min,sec
  MONTH_HOURS  "%02d:%02d:%06.3f"                 epoch_hours,min,sec
  MONTH_HOURS2 "%03d:%02d:%02.0f"                 epoch_hours,min,sec
  YMD          "%04d-%02d-%02d"                   yr,mon,day
  DHMS         "%03d %02d:%02d:%02.0f"            day-1,hr,min,sec
  EPOCH_DAYS   "%04d %02d:%02d:%02.0f"            epoch_days,hr,min,sec
  EPOCH_DAYS2  "%03d %02d:%02d:%04.1f"            epoch_days,hr,min,sec
  </pre>

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> str - A string date-time representation to be parsed.

<dd> format - A TimeFormat code.

<dt> <b>Returns:</b>
<dd> The epochal time. Returns TIME_NULL if the string cannot be parsed.

</dl></dd>
</dl>
<!Begin-Footer><hr>
<pre>
<a href="directories.html">All directories</a>  <a href="libsrc_libtime.html">This Directory</a>  <a href="libsrc_libtime.html#_top_">Previous</a>  <a href="libsrc_libtime_timeUtil.c.html#_top_">Next</a>  <a href="AllNames.html">Index</a></pre>
</body>
</html>
