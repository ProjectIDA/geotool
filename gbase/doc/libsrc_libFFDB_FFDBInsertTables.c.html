<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!--NewPage-->
<html>
<head>
<!-- Generated by cdoc on Wed Jan 26 05:45:09 2005 -->
<title>
file libsrc/libFFDB/FFDBInsertTables.c
</title>
</head>
<body>
<a name="_top_"></a><pre>
<a href="directories.html">All directories</a>  <a href="libsrc_libFFDB.html">This Directory</a>  <a href="libsrc_libFFDB_FFDBImport.c.html#_top_">Previous</a>  <a href="libsrc_libFFDB_FFDBOpen.c.html#_top_">Next</a>  <a href="AllNames.html">Index</a></pre>
<hr>
<h1>
File libsrc/libFFDB/FFDBInsertTables.c
</h1>
<hr>
<!End-Header>  These routines insert one or more records into the database.
<hr>
<h2>
Public Function Index
</h2>
<dl>
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#FFDBConvertDateToDir"><b>FFDBConvertDateToDir</b></a> (const char *, double, char *)
<dd> Convert a time to a database directory path.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#FFDBCreateAuthor"><b>FFDBCreateAuthor</b></a> (FFDatabase, const char *)
<dd> Create an author directory.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#FFDBCreateDir"><b>FFDBCreateDir</b></a> (const char *)
<dd> Create a database directory.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#FFDBInsertTable"><b>FFDBInsertTable</b></a> (FFDatabase, CssTable, const char *)
<dd> Insert one table record.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#FFDBInsertTables"><b>FFDBInsertTables</b></a> (FFDatabase, int, CssTable *, const char *)
<dd> Insert more than one table record.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#FFDBWriteStaticTable"><b>FFDBWriteStaticTable</b></a> (FFDatabase, CssTable)
<dd> Write a static table record to the database.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#FFDBWriteTable"><b>FFDBWriteTable</b></a> (FFDatabase, CssTable, const char *, double)
<dd> Write a table record to the database.
</dl>
<h2>
Public Functions
</h2>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="FFDBConvertDateToDir"><b>FFDBConvertDateToDir</b></a>
<pre>
 int FFDBConvertDateToDir(const char *directory_structure,
                          double time,
                          char *dir)
</pre>
<dl>
<dd>  Convert a time to a database directory path. Using the input
  <b>directory_structure</b> as an strptime format, return the directory path.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> directory_str - An strftime/strptime format for the database directories.

<dd> time - An epochal time.

<dd> dir - The output directory path.

<dt> <b>Returns:</b>
<dd> 0 for success,  FFDB_BAD_STRUCTURE for failure.  Retrieve the   error message with FFDBErrMsg().

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="FFDBCreateAuthor"><b>FFDBCreateAuthor</b></a>
<pre>
 int FFDBCreateAuthor(FFDatabase ffdb,
                      const char *author)
</pre>
<dl>
<dd>  Create an author directory.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> ffdb - An FFDatabase pointer obtained from FFDBOpen().

<dd> author - An author name.

<dt> <b>Returns:</b>
<dd> 0 for success, FFDB_CREATE_DIR_ERR for failure.  Retrieve the  error message with FFDBErrno() and FFDBErrMsg().

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="FFDBCreateDir"><b>FFDBCreateDir</b></a>
<pre>
 int FFDBCreateDir(const char *path)
</pre>
<dl>
<dd>  Create a database directory. Create all directories in the input path.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> path - A database path.

<dt> <b>Returns:</b>
<dd> 0 for success,  FFDB_CREATE_DIR_ERR for failure.  Retrieve  the  error message with FFDBErrMsg().

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="FFDBInsertTable"><b>FFDBInsertTable</b></a>
<pre>
 int FFDBInsertTable(FFDatabase ffdb,
                     CssTable table,
                     const char *authorOrStation)
</pre>
<dl>
<dd>  Insert one table record. Insert a table record into the appropriate directory
  and file of the database. Database directories and files are created as
  needed. The time associated with the record and the database directory
  structure determine the destination of the input record. The third argument
  <b>authorOrStation</b> is the author of the input record for all tables
  except "wfdisc". For wfdisc tables, the third argument is the station or
  network name.
  <p>
  If the input table record contains a "time" member, the value of that member
  is used to place the record. Otherwise, if the input table record contains
  an "orid" or an "arid" member, or the input table is an orid or arid wftag,
  the database is searched for the corresponding origin or arrival record from
  which the time can be obtained.
  <p>
  If the input record does not have a "time" member and cannot be associated
  with an origin or arrival, then it will not be written to the database,
  and the return code will be FFDB_NO_TIME.
  <p>
  The following tables that are not time dependent are automatically placed
  in a directory named "static" under the parameter root directory:
  "affiliation", "site", "sitechan", "instrument", "sensor", and "lastid".
  <p>
  If the author does not exist, it will be created. It the author exist, but
  is not writable, FFDB_AUTHOR_WRITE_ERR will be returned.
  <p>
  FFDBInsertTable returns 0 for success or a nonzero error code.
  The following errors can occur:
  <pre>
    FFDB_NO_TIME           Cannot determine the time for the input record.
    FFDB_CREATE_DIR_ERR    Cannot create the database directory.
    FFDB_OPEN_DIR_ERR      Cannot open the database directory.
    FFDB_BAD_STRUCTURE     The directory structure format is invalid.
    FFDB_OPENW_FILE_ERR    Cannot open the output file for writing.
    FFDB_STAT_FILE_ERR     Cannot stat() the output file.
    FFDB_TABLE_WRITE_ERR   An error occurred while writing the record.
    FFDB_AUTHOR_WRITE_ERR  The author is not writable.
  </pre>
    

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> ffdb - An FFDatabase pointer obtained from FFDBOpen().

<dd> table - The CssTable object whose elements will be inserted.

<dd> authorOrStation - The author or the station directory name.

<dt> <b>Returns:</b>
<dd> 0 for success,  nonzero for failure.  Retrieve the error number  and the error message with FFDBErrno() and FFDBErrMsg().

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="FFDBInsertTables"><b>FFDBInsertTables</b></a>
<pre>
 int FFDBInsertTables(FFDatabase ffdb,
                      int num,
                      CssTable *tables,
                      const char *authorOrStation)
</pre>
<dl>
<dd>  Insert more than one table record. 

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> ffdb - An FFDatabase pointer obtained from FFDBOpen().

<dd> num - The number of records to insert from tables[].

<dd> tables - The CssTable objects whose elements will be inserted.

<dd> author - The author or station directory name.

<dt> <b>Returns:</b>
<dd> 0 for success,  nonzero for failure.  Retrieve the error number  and the error message with FFDBErrno() and FFDBErrMsg().

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="FFDBWriteStaticTable"><b>FFDBWriteStaticTable</b></a>
<pre>
 int FFDBWriteStaticTable(FFDatabase ffdb,
                          CssTable table)
</pre>
<dl>
<dd>  Write a static table record to the database. Write a static table record to
  the database in the "static" directory under the parameter root.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> ffdb - An FFDatabase pointer obtained from FFDBOpen().

<dd> table - The CssTable object whose elements will be written.

<dt> <b>Returns:</b>
<dd> 0 for success,  nonzero for failure.  Retrieve the error number  and the error message with FFDBErrMsg().

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="FFDBWriteTable"><b>FFDBWriteTable</b></a>
<pre>
 int FFDBWriteTable(FFDatabase ffdb,
                    CssTable table,
                    const char *authorOrStation,
                    double time)
</pre>
<dl>
<dd>  Write a table record to the database. Write a table record to the database
  using the input author or station name and the input time. If the table
  is a wfdisc, the <b>authorOrStation</b> argument should be a station name.
  For all others tables, the <b>authorOrStation</b> argument should be an
  author name. If the author does not exist, it will be created. It the
  author exist, but is not writable, FFDB_AUTHOR_WRITE_ERR will be returned.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> ffdb - An FFDatabase pointer obtained from FFDBOpen().

<dd> table - The CssTable object whose elements will be written.

<dd> authorOrStation - The author or the station directory name.

<dd> time - The epochal time associated with the record.

<dt> <b>Returns:</b>
<dd> 0 for success,  nonzero for failure.  Retrieve the error number  and the error message with FFDBErrno() and FFDBErrMsg().

</dl></dd>
</dl>
<!Begin-Footer><hr>
<pre>
<a href="directories.html">All directories</a>  <a href="libsrc_libFFDB.html">This Directory</a>  <a href="libsrc_libFFDB_FFDBImport.c.html#_top_">Previous</a>  <a href="libsrc_libFFDB_FFDBOpen.c.html#_top_">Next</a>  <a href="AllNames.html">Index</a></pre>
</body>
</html>
