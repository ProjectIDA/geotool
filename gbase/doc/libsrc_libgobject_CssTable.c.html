<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!--NewPage-->
<html>
<head>
<!-- Generated by cdoc on Wed Jan 26 05:45:09 2005 -->
<title>
file libsrc/libgobject/CssTable.c
</title>
</head>
<body>
<a name="_top_"></a><pre>
<a href="directories.html">All directories</a>  <a href="libsrc_libgobject.html">This Directory</a>  <a href="libsrc_libgobject_cssObjects.c.html#_top_">Previous</a>  <a href="libsrc_libgobject_DataLoop.c.html#_top_">Next</a>  <a href="AllNames.html">Index</a></pre>
<hr>
<h1>
File libsrc/libgobject/CssTable.c
</h1>
<hr>
<!End-Header> <h2>CssTable Class</h2>
  <p>
  The CssTable class contains routines that read, write and work with
  tables (schema). Specific tables are represented by subclasses
  of the CssTable base class. The class structure for CssTable is
   <pre>
  typedef struct
  {
       GObjectPart    core;
       CssTablePart   css;
 
  } *CssTable;
  </pre>
  Subclasses are defined by adding specific table members to this structure.
  For example, the CssSensor class that represents the Sensor table is defined
  as
  <pre>
  typedef struct
  {
      GObjectPart     core;
      CssTablePart    css;
 
      char    sta[7];         /* station code         */
      char    chan[9];        /* channel code         */
      double  time;           /* epoch time of start of recording period */
      double  endtime;        /* epoch time of end of recording period */
      long    inid;           /* instrument id        */
      long    chanid;         /* channel id           */
      long    jdate;          /* julian date          */
      float   calratio;       /* calibration          */
      float   calper;         /* calibration period   */
      float   tshift;         /* correction of data processing time */
      char    instant[2];     /* (y,n) discrete/continuing snapshot */
      char    lddate[18];     /* load date            */
 
      /* extra members for geotool internal use */
      int     sta_quark;
      int     chan_quark;
  } *CssSensor;
  </pre>
  The Sensor table members are added to the class structure after CssTablePart.
  Extra members can also be added to the structure, such as the sta_quark and
  chan_quark members. These members are not part of the Sensor schema and
  are not read from or written to the database or sensor file. They are
  used only within the program and are placed in the Sensor subclass for
  convenience. Here the sta_quark and chan_quark members are quarks of the
  Sensor sta and chan strings.
  <p>
 
  The CssTablePart holds the description of the subclass and is privately
  defined as:
  <pre>
  typedef struct CssTable_struct
  {
       int             type;
       int             name;
       int             num_members;
       CssDescription  *des;
       int             num_extra;
       CssExtra        *extra;
       int             num_bytes;
       int             line_length;
       ...
  } *CssTablePart;
  </pre>
 
  The CssTablePart holds a description of the table; the table name, the
  number of table members, the number of extra members, the printed line
  length, etc. The CssDescription is a structure that describes each
  table members. There is a CssDescription structure for each member.
  The CssExtra is a structure that describes each extra member.
  <p>
  Many CSS table are predefined in the library (see cssObjects.c). Additional
  table subclasses can be dynamically defined using the CssTable_define
  routine. Create any CssTable subclass object with new_CssTable.
<hr>
<h2>
Public Function Index
</h2>
<dl>
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_isCssTable"><b>CssTable_isCssTable</b></a> (GObject)
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_isTableName"><b>CssTable_isTableName</b></a> (char *)
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_getAllNames"><b>CssTable_getAllNames</b></a> (const char ***)
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_terminate"><b>CssTable_terminate</b></a> ()
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_define"><b>CssTable_define</b></a> (const char *, int, CssDescription *, int, CssExtra *, int)
<dd> Define a CssTable type.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_redefine"><b>CssTable_redefine</b></a> (const char *, int, CssDescription *, int, CssExtra *, int)
<dd> Redefine a CssTable type.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_description"><b>CssTable_description</b></a> (CssTable)
<dd> Return the CssDescription for a CssTable object.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_getDescription"><b>CssTable_getDescription</b></a> (const char *, CssDescription **)
<dd> Get the description of a CssTable.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_getExtra"><b>CssTable_getExtra</b></a> (const char *, CssExtra **)
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#new_CssTable"><b>new_CssTable</b></a> (const char *)
<dd> Create a CssTable object.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#new_CssTables"><b>new_CssTables</b></a> (const char *, int, CssTable *)
<dd> Create an array CssTable object.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_copyTable"><b>CssTable_copyTable</b></a> (CssTable, CssTable)
<dd> Copy a CssTable.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_member"><b>CssTable_member</b></a> (CssTable, int)
<dd> Get a CssTable member name from the member index.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_read"><b>CssTable_read</b></a> (CssTable, FILE *, const char **)
<dd> Read a single CssTable from a file.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_write"><b>CssTable_write</b></a> (CssTable, FILE *, const char **)
<dd> Write a single CssTable to a file.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_memberIndex"><b>CssTable_memberIndex</b></a> (CssTable, const char *)
<dd> Return a CssTable member index.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_memberOffset"><b>CssTable_memberOffset</b></a> (CssTable, const char *)
<dd> Return a CssTable member's offset from the CssTable pointer.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_setMember"><b>CssTable_setMember</b></a> (CssTable, int, const char *)
<dd> Set the value of a CssTable member.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_setExtra"><b>CssTable_setExtra</b></a> (CssTable, int, const char *)
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_toString"><b>CssTable_toString</b></a> (CssTable)
<dd> Write the CssTable members as a character string.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_memberToString"><b>CssTable_memberToString</b></a> (CssTable, int, char *, int)
<dd> Convert a CssTable member to a character string.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_getError"><b>CssTable_getError</b></a> ()
<dd> Return an error message.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_getCssSize"><b>CssTable_getCssSize</b></a> (CssTable)
<dd> Get the CssTable size, excluding extra non-standard members.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_getType"><b>CssTable_getType</b></a> (CssTable)
<dd> Get the CssTable type.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#*CssTable_getName"><b>*CssTable_getName</b></a> (CssTable)
<dd> Get the CssTable name.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_numMembers"><b>CssTable_numMembers</b></a> (CssTable)
<dd> Get the number of members in a CssTable.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_lineLength"><b>CssTable_lineLength</b></a> (CssTable)
<dd> Get the length of the string representation of a CssTable.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_selected"><b>CssTable_selected</b></a> (CssTable)
<dd> Get the selected attribute of a CssTable.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_setFileOffset"><b>CssTable_setFileOffset</b></a> (CssTable, int)
<dd> Set the file offset attribute of a CssTable
.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_setSelected"><b>CssTable_setSelected</b></a> (CssTable, bool)
<dd> Set the selected attribute of a CssTable.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_copySource"><b>CssTable_copySource</b></a> (CssTable, CssTable, int)
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_filePosition"><b>CssTable_filePosition</b></a> (CssTable)
<dd> Get the file offset associated with a CssTable object.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_setSource"><b>CssTable_setSource</b></a> (CssTable, int, int, int)
<dd> Set the data source information in a CssTable object.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_getSource"><b>CssTable_getSource</b></a> (CssTable, int *, int *, int *)
<dd> Get data source information associated with a CssTable object.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_setAccount"><b>CssTable_setAccount</b></a> (CssTable, int, int)
<dd> Set the account and table name information in a CssTable object.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_getAccount"><b>CssTable_getAccount</b></a> (CssTable, int *, int *)
<dd> Get the account and table name information in a CssTable object.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_setDirectoryStructure"><b>CssTable_setDirectoryStructure</b></a> (CssTable, int, double)
<dd> Set the directory-structure and the directory-duration for a CssTable object 
  related to a Flat-File Database.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_getDirectoryStructure"><b>CssTable_getDirectoryStructure</b></a> (CssTable, int *, double *)
<dd> Get the directory-structure and the directory-duration of a CssTable object 
  related to a Flat-File Database.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_sort"><b>CssTable_sort</b></a> (Vector, const char *)
<dd> Sort a Vector of CssTable objects by the specified member.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_sortTable"><b>CssTable_sortTable</b></a> (CssTable *, int, const char *)
<dd> Sort an array of CssTable objects by the specified member.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_find"><b>CssTable_find</b></a> (Vector, const char *, long)
<dd> Find a CssTable object that has the specified member value.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_getValue"><b>CssTable_getValue</b></a> (CssTable, const char *, const char *, void *)
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_putValue"><b>CssTable_putValue</b></a> (CssTable, const char *, const char *, void *)
<dd> Store a hashtable value in a CssTable object.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_putBlock"><b>CssTable_putBlock</b></a> (CssTable, const char *, const char *, int, void *)
<dd> Store a block of memory a CssTable object's hashtable.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_getStringValue"><b>CssTable_getStringValue</b></a> (CssTable, const char *, const char *, char *, int)
<dd> Return a hashtable value as a string.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_replaceValue"><b>CssTable_replaceValue</b></a> (CssTable, const char *, const char *)
<dd> Replace a hashtable value from a string.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#CssTable_readFile"><b>CssTable_readFile</b></a> (const char *, struct stat *, const char *, Vector, const char **)
<dd> Read a file of CSS table records.
</dl>
<h2>
Public Functions
</h2>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_isCssTable"><b>CssTable_isCssTable</b></a>
<pre>
 bool CssTable_isCssTable(GObject o)
</pre>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_isTableName"><b>CssTable_isTableName</b></a>
<pre>
 bool CssTable_isTableName(char *name)
</pre>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_getAllNames"><b>CssTable_getAllNames</b></a>
<pre>
 int CssTable_getAllNames(const char ***cssTableNames)
</pre>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_terminate"><b>CssTable_terminate</b></a>
<pre>
 void CssTable_terminate()
</pre>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_define"><b>CssTable_define</b></a>
<pre>
 int CssTable_define(const char *name,
                     int num_members,
                     CssDescription *des,
                     int num_extra,
                     CssExtra *extra,
                     int size)
</pre>
<dl>
<dd>  Define a CssTable type. Define a new CssTable type. Call this routine once
  for each new CssTable type. After a CssTable type (subclass) is defined
  by this routine, CssTable objects of the type can be created with 
  new_CssTable(type_name). The CssDescription that describes each table
  member is
  <pre>
  typedef struct
  {
     int     start;       /* Character position in the printed line (>=1) */
     int     end;         /* Character position in the printed line (>=1) */
     char    name[32];    /* Member name. */
     char    format[8];   /* Format for printing. */
     int     offset;      /* Byte offset from the table structure pointer */
     int     size;        /* Size in bytes */
     int     quark_offset;/* Byte offset of an extra member that is a */
                                 quark for this member (or -1) */
     int     type;        /* Data type */
     char    null_value[16]; /* Initial value */
  } CssDescription;
  </pre>
  The CssExtra structure is used to describe "extra" table members that are
  in the structure but are only used within the program. They are not read
  from or written to a database or file. The CssExtra structure is
  <pre>
  typedef struct
  {
     char    name[32];    /* Member name. */
     char    format[8];   /* Format for printing. */
     int     offset;      /* Byte offset from the table structure pointer */
     int     size;        /* Size in bytes */
     int     type;        /* Data type */
     char    null_value[16]; /* Initial value */
  } CssExtra;
  </pre>
  The data types are
  <pre>
      CSS_STRING for char *
      CSS_DOUBLE for double
      CSS_FLOAT  for float
      CSS_INT    for int
      CSS_LONG   for long
      CSS_TIME   for double epochal time.
      CSS_DATE   for DateTime date
      CSS_LDDATE for DateTime load date
      CSS_QUARK  for int quark
      CSS_BOOL   for bool
  </pre>
  For example, the code from cssObjects.c that defines the CssSensor class
  is
  <pre>
 static bool
 defineSensor()
 {
 #define offset(field)   Offset(CssSensor, field)
     CssDescription des[] = {
       {1,     6,      "sta",   "%s", offset(sta),  offset(sta_quark), CSS_STRING,  "-"},
       {8,    15,     "chan",   "%s", offset(chan),offset(chan_quark), CSS_STRING,  "-"},
       {17,   33,     "time","%.5lf", offset(time),                -1, CSS_TIME, T_NULL},
       {35,   51,  "endtime","%.5lf", offset(endtime),             -1, CSS_TIME, T_NULL},
       {53,   60,     "inid",  "%ld", offset(inid),                -1, CSS_LONG,   "-1"},
       {62,   69,   "chanid",  "%ld", offset(chanid),              -1, CSS_LONG,   "-1"},
       {71,   78,    "jdate",  "%ld", offset(jdate),               -1, CSS_LONG,   "-1"},
       {80,   95, "calratio",   "%f", offset(calratio),            -1, CSS_FLOAT,  "0."},
       {97,  112,   "calper",   "%f", offset(calper),              -1, CSS_FLOAT, "-1."},
       {114, 119,   "tshift",   "%f", offset(tshift),              -1, CSS_FLOAT,  "0."},
       {121, 121,  "instant",   "%s", offset(instant),             -1, CSS_STRING,  "-"},
       {123, 139,   "lddate",   "%s", offset(lddate),              -1, CSS_LDDATE,    DTNULL},
     };
     CssExtra extra[] = {
          {offset(sta_quark),   CSS_INT, "0"},
          {offset(chan_quark),  CSS_INT, "0"},
     };
 #undef offset
     CssSensor table;
  
     return (bool)CssTable_define("sensor", 12, des, 2, extra, sizeof(*table));
 }
  </pre>
  

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> name - The table name.

<dd> num_members - The number of members in the table.

<dd> des - An array of num_members CssDescription structures.

<dd> num_extra - The number of extra members.

<dd> extra - An array of num_extra CssExtra structures.

<dd> size - The total size of the subclass structure.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_redefine"><b>CssTable_redefine</b></a>
<pre>
 int CssTable_redefine(const char *name,
                       int num_members,
                       CssDescription *des,
                       int num_extra,
                       CssExtra *extra,
                       int size)
</pre>
<dl>
<dd>  Redefine a CssTable type. Use this routine to redefine the definition
  of a table type. (CssTable_define can only be called once.) Do not redefine
  a table type that is still being used by object instances. Delete all
  objects of that type before redefining the table.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> name - The table name.

<dd> num_members - The number of members in the table.

<dd> des - An array of num_members CssDescription structures.

<dd> num_extra - The number of extra members.

<dd> extra - An array of num_extra CssExtra structures.

<dd> size - The total size of the subclass structure.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_description"><b>CssTable_description</b></a>
<pre>
 CssDescription *CssTable_description(CssTable o)
</pre>
<dl>
<dd>  Return the CssDescription for a CssTable object.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> o - A CssTable object.

<dt> <b>Returns:</b>
<dd> The CssDescription for the object.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_getDescription"><b>CssTable_getDescription</b></a>
<pre>
 int CssTable_getDescription(const char *name,
                             CssDescription **des)
</pre>
<dl>
<dd>  Get the description of a CssTable. Returns an array of CssDescription
  structures. The CssDescription structure is defined as:
  <pre>
  typedef struct
  {
        int     start;
        int     end;
        char    *name;
        char    *format;
        int     offset;
        int     quark_offset;
        int     type;
        char    *null_value;
  } CssDescription;
  </pre>
  not free it.)

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> name - The CssTable name.

<dd> des - Returned pointer to an array of CssDescription structures. (Do

<dt> <b>Returns:</b>
<dd> the number of table members and elements in des. Returns -1 if the  name is not found.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_getExtra"><b>CssTable_getExtra</b></a>
<pre>
 int CssTable_getExtra(const char *name,
                       CssExtra **extra)
</pre>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="new_CssTable"><b>new_CssTable</b></a>
<pre>
 CssTable new_CssTable(const char *name)
</pre>
<dl>
<dd>  Create a CssTable object. This routine will return a new CssTable object
  for any table subclass that has been defined by calling CssTable_define.
  The following tables are predefined in the library: affiliation, ampdescript,
  amplitude, arrival, assoc, dervdisc, filter, fsave, fsdisc, fsrecipe, fstag,
  hydrofeatures, infrafeatures, instrument, lastid, netmag, origin, origerr,
  origaux, pick, pmcc_features, pmcc_recipe, sensor, site, sitechan, spdisc,
  staconf, stamag, stanet, stassoc, wfdisc, wftag, xtag.
 

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> name - The input table name.

<dt> <b>Returns:</b>
<dd> A CssTable object. Returns NULL, if the name has not been defined.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="new_CssTables"><b>new_CssTables</b></a>
<pre>
 int new_CssTables(const char *name,
                   int num,
                   CssTable *tables)
</pre>
<dl>
<dd>  Create an array CssTable object. This routine will return an array of new
  CssTable objects for any table subclass that has been defined by calling
  CssTable_define. This routine is much more efficient at creating many
  CssTable objects than new_CssTable. However, the memory space for all of
  the objects in the array is allocated in a single block and will not be
  released until GObject_free has been called for all objects in the array.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> name - The input table name.

<dd> num - The input number of table objects to create.

<dd> A - pointer to an array of length num that will receive the objects.

<dt> <b>Returns:</b>
<dd> 0 for success, -1 for failure.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_copyTable"><b>CssTable_copyTable</b></a>
<pre>
 bool CssTable_copyTable(CssTable c1,
                         CssTable c2)
</pre>
<dl>
<dd>  Copy a CssTable. Copy the member values of one CssTable to another CssTable.
  Copy <b>c2</b> member values to <b>c1</b> members.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> c1 - A CssTable.

<dd> c2 - A CssTable of the same type as c1. Copy values from c1 to c2.

<dt> <b>Returns:</b>
<dd> True for success, False for error (logErrorMsg is called).

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_member"><b>CssTable_member</b></a>
<pre>
 char *CssTable_member(CssTable o,
                       int index)
</pre>
<dl>
<dd>  Get a CssTable member name from the member index.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> o - A CssTable object.

<dd> index - The member index.

<dt> <b>Returns:</b>
<dd> A static character string containing the name, or NULL for an error. (logErrorMsg is called)

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_read"><b>CssTable_read</b></a>
<pre>
 int CssTable_read(CssTable o,
                   FILE *fp,
                   const char **err_msg)
</pre>
<dl>
<dd>  Read a single CssTable from a file.
  <pre>
            CSS_BAD_OBJECT        o is not a CssTable
            CSS_MALLOC_ERROR      malloc failed
 	     CSS_WRONG_FORMAT      format error
            EOF               End of file encountered
  </pre>

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> o - A CssTable object.

<dd> fp - A FILE pointer to an open file.

<dd> err_msg - On error, if err_msg != NULL, *err_msg is set to a static  char error message.

<dt> <b>Returns:</b>
<dd> 0 for success, CSS_BAD_OBJECT if o is not a CssTable,  CSS_MALLOC_ERROR, CSS_WRONG_FORMAT, EOF (logErrorMsg is called for a  nonzero return)

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_write"><b>CssTable_write</b></a>
<pre>
 int CssTable_write(CssTable o,
                    FILE *fp,
                    const char **err_msg)
</pre>
<dl>
<dd>  Write a single CssTable to a file. The error return codes are
  <pre>
            CSS_BAD_OBJECT        o is not a CssTable
            CSS_MALLOC_ERROR      malloc failed
 	     CSS_WRITE_ERROR       system write error
  </pre>

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> o - A CssTable object.

<dd> fp - A FILE pointer to an open file.

<dd> err_msg - On error, *err_msg is set to a static char error message.

<dt> <b>Returns:</b>
<dd> 0 for success, nonzero for error. logErrorMsg is called before a  nonzero return.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_memberIndex"><b>CssTable_memberIndex</b></a>
<pre>
 int CssTable_memberIndex(CssTable o,
                          const char *member_name)
</pre>
<dl>
<dd>  Return a CssTable member index.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> o - A CssTable object.

<dd> member_name - A member name.

<dt> <b>Returns:</b>
<dd> The member index, or -1 if member_name is not found,  -2 if o is not a CssTable.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_memberOffset"><b>CssTable_memberOffset</b></a>
<pre>
 int CssTable_memberOffset(CssTable o,
                           const char *member_name)
</pre>
<dl>
<dd>  Return a CssTable member's offset from the CssTable pointer.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> o - A CssTable object.

<dd> member_name - A member name.

<dt> <b>Returns:</b>
<dd> The member offset, or -1 if member_name is not found,  -2 if o is not a CssTable.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_setMember"><b>CssTable_setMember</b></a>
<pre>
 bool CssTable_setMember(CssTable o,
                         int member_index,
                         const char *value)
</pre>
<dl>
<dd>  Set the value of a CssTable member. The input string representation
  of the member value is converted to the appropriate member data type.
  If the member type is CSS_TIME, the value can be input in any format that
  is recognized by timeParseString. 

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> o - A CssTable object.

<dd> member_index - A member index.

<dd> value - A pointer to the new string value.

<dt> <b>Returns:</b>
<dd> True for success, False if conversion from the string input fails.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_setExtra"><b>CssTable_setExtra</b></a>
<pre>
 bool CssTable_setExtra(CssTable o,
                        int member_index,
                        const char *value)
</pre>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_toString"><b>CssTable_toString</b></a>
<pre>
 char *CssTable_toString(CssTable o)
</pre>
<dl>
<dd>  Write the CssTable members as a character string. Free the string after use.
  fails. (logErrorMsg is called)

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> o - A CssTable object.

<dt> <b>Returns:</b>
<dd> a character string. Returns NULL if o is not a CssTable or malloc

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_memberToString"><b>CssTable_memberToString</b></a>
<pre>
 int CssTable_memberToString(CssTable o,
                             int member_index,
                             char *buf,
                             int buf_len)
</pre>
<dl>
<dd>  Convert a CssTable member to a character string.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> o - A CssTable object.

<dd> member_index - The member index.

<dd> buf - A character array to hold the output.

<dd> buf_len - The length of <b>buf</b>.

<dt> <b>Returns:</b>
<dd> 0 for success, -1 for an invalid member index.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_getError"><b>CssTable_getError</b></a>
<pre>
 char *CssTable_getError()
</pre>
<dl>
<dd>  Return an error message. (A static char string.)

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_getCssSize"><b>CssTable_getCssSize</b></a>
<pre>
 int CssTable_getCssSize(CssTable o)
</pre>
<dl>
<dd>  Get the CssTable size, excluding extra non-standard members.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_getType"><b>CssTable_getType</b></a>
<pre>
 int CssTable_getType(CssTable o)
</pre>
<dl>
<dd>  Get the CssTable type.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="*CssTable_getName"><b>*CssTable_getName</b></a>
<pre>
 const char *CssTable_getName(CssTable o)
</pre>
<dl>
<dd>  Get the CssTable name.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_numMembers"><b>CssTable_numMembers</b></a>
<pre>
 int CssTable_numMembers(CssTable o)
</pre>
<dl>
<dd>  Get the number of members in a CssTable.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_lineLength"><b>CssTable_lineLength</b></a>
<pre>
 int CssTable_lineLength(CssTable table)
</pre>
<dl>
<dd>  Get the length of the string representation of a CssTable.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_selected"><b>CssTable_selected</b></a>
<pre>
 int CssTable_selected(CssTable table)
</pre>
<dl>
<dd>  Get the selected attribute of a CssTable.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_setFileOffset"><b>CssTable_setFileOffset</b></a>
<pre>
 void CssTable_setFileOffset(CssTable table,
                             int i)
</pre>
<dl>
<dd>  Set the file offset attribute of a CssTable

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_setSelected"><b>CssTable_setSelected</b></a>
<pre>
 void CssTable_setSelected(CssTable table,
                           bool b)
</pre>
<dl>
<dd>  Set the selected attribute of a CssTable.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_copySource"><b>CssTable_copySource</b></a>
<pre>
 void CssTable_copySource(CssTable dest,
                          CssTable src,
                          int id)
</pre>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_filePosition"><b>CssTable_filePosition</b></a>
<pre>
 int CssTable_filePosition(CssTable table)
</pre>
<dl>
<dd>  Get the file offset associated with a CssTable object.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_setSource"><b>CssTable_setSource</b></a>
<pre>
 void CssTable_setSource(CssTable table,
                         int data_source,
                         int user,
                         int passwd)
</pre>
<dl>
<dd>  Set the data source information in a CssTable object. Information
  is input as quarks. Use stringToQuark() to convert to a quark.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> table - A CssTable object.

<dd> data_source - quark data_source.

<dd> user - quark user.

<dd> passwd - quark password.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_getSource"><b>CssTable_getSource</b></a>
<pre>
 void CssTable_getSource(CssTable table,
                         int *data_source,
                         int *user,
                         int *passwd)
</pre>
<dl>
<dd>  Get data source information associated with a CssTable object. Information
  is returned a quarks. Use quarkToString() to convert to a char string.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> table - A CssTable object.

<dd> data_source - returned quark data_source.

<dd> user - returned quark user.

<dd> passwd - return quark password.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_setAccount"><b>CssTable_setAccount</b></a>
<pre>
 void CssTable_setAccount(CssTable table,
                          int account,
                          int table_name)
</pre>
<dl>
<dd>  Set the account and table name information in a CssTable object. Information
  is input as quarks. Use stringToQuark() to convert to a quark. The table
  name refers to a database table name and can be different from the actual
  CssTable name. For example, the CssTable name might be "arrival" and the
  table_name might be parrival.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> table - A CssTable object.

<dd> account - quark account.

<dd> table_name - quark table name.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_getAccount"><b>CssTable_getAccount</b></a>
<pre>
 void CssTable_getAccount(CssTable table,
                          int *account,
                          int *table_name)
</pre>
<dl>
<dd>  Get the account and table name information in a CssTable object. Information
  is returned as quarks. Use quarkToString() to convert to a string. The table
  name refers to a database table name and can be different from the actual
  CssTable name. For example, the CssTable name might be "arrival" and the
  table_name might be parrival.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> table - A CssTable object.

<dd> account - returned quark account.

<dd> table_name - returned quark table name.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_setDirectoryStructure"><b>CssTable_setDirectoryStructure</b></a>
<pre>
 void CssTable_setDirectoryStructure(CssTable table,
                                     int directory_structure,
                                     double directory_duration)
</pre>
<dl>
<dd>  Set the directory-structure and the directory-duration for a CssTable object 
  related to a Flat-File Database. Input the directory_structure as a quark.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> table - A CssTable object.

<dd> directory_structure - The directory structure of a Flat-File database.

<dd> directory_duration - The directory duration of a Flat-File database.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_getDirectoryStructure"><b>CssTable_getDirectoryStructure</b></a>
<pre>
 void CssTable_getDirectoryStructure(CssTable table,
                                     int *directory_structure,
                                     double *directory_duration)
</pre>
<dl>
<dd>  Get the directory-structure and the directory-duration of a CssTable object 
  related to a Flat-File Database. The directory_structure is returned as a
  quark.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> table - A CssTable object.

<dd> directory_structure - The directory structure of a Flat-File database.

<dd> directory_duration - The directory duration of a Flat-File database.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_sort"><b>CssTable_sort</b></a>
<pre>
 int CssTable_sort(Vector tables,
                   const char *member_name)
</pre>
<dl>
<dd>  Sort a Vector of CssTable objects by the specified member. Possible errors
  are a bad Vector object, Vector objects are not all the same CssTable,
  invalid member_name and unknown member type. logErrorMsg is called before
  a error (nonzero) return.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> tables - a Vector containing CssTable objects.

<dd> member_name - The table member that will be sorted.

<dt> <b>Returns:</b>
<dd> 0 for success, nonzero for an error condition.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_sortTable"><b>CssTable_sortTable</b></a>
<pre>
 int CssTable_sortTable(CssTable *tables,
                        int num,
                        const char *member_name)
</pre>
<dl>
<dd>  Sort an array of CssTable objects by the specified member. Possible errors
  are objects are not all the same CssTable, invalid member_name and
  unknown member type. logErrorMsg is called before a error (nonzero) return.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> tables - an array of CssTable objects.

<dd> member_name - The table member that will be sorted.

<dt> <b>Returns:</b>
<dd> 0 for success, nonzero for an error condition.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_find"><b>CssTable_find</b></a>
<pre>
 CssTable CssTable_find(Vector tables,
                        const char *member_name,
                        long value)
</pre>
<dl>
<dd>  Find a CssTable object that has the specified member value. The member
  data type must be long. Possible errors are a bad object, invalid
  member_name, invalid member data type.
  logErrorMsg is called if an error occurred.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> tables - A Vector of CssTable objects.

<dd> member_name - The table member that will be searched.

<dd> value - The value that will be search for.

<dt> <b>Returns:</b>
<dd> a CssTable for success, NULL if not found or an error occurred.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_getValue"><b>CssTable_getValue</b></a>
<pre>
 int CssTable_getValue(CssTable a,
                       const char *name,
                       const char *value_type,
                       void *value_addr)
</pre>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_putValue"><b>CssTable_putValue</b></a>
<pre>
 int CssTable_putValue(CssTable a,
                       const char *name,
                       const char *value_type,
                       void *value_addr)
</pre>
<dl>
<dd>  Store a hashtable value in a CssTable object.  Each CssTable
  object has a private hashtable in which related information can be stored.
  Character strings, floats, doubles, longs and ints can be stored in the
  hashtable.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> a - A CssTable object.

<dd> name - The name associated with the value.

<dd> value_type - The data type of the value. ("string", "float", "double", "long", or "int")

<dd> value_addr - The address of the value. The value will be copied.

<dt> <b>Returns:</b>
<dd> 0 for success, -1 an error occurred (logErrorMsg is called)

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_putBlock"><b>CssTable_putBlock</b></a>
<pre>
 int CssTable_putBlock(CssTable a,
                       const char *name,
                       const char *value_type,
                       int value_size,
                       void *value_addr)
</pre>
<dl>
<dd>  Store a block of memory a CssTable object's hashtable.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> a - A CssTable object.

<dd> name - The name associated with the value.

<dd> value_type - Must be "block".

<dd> value_size - The number of bytes in the block.

<dd> value_addr - The address of the block. The block will be copied.

<dt> <b>Returns:</b>
<dd> 0 for success, -1 an error occurred (logErrorMsg is called)

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_getStringValue"><b>CssTable_getStringValue</b></a>
<pre>
 int CssTable_getStringValue(CssTable a,
                             const char *name,
                             const char *format,
                             char *buf,
                             int buflen)
</pre>
<dl>
<dd>  Return a hashtable value as a string. Return a value from a CssTable's
  hashtable as a string, regardless of the value's data type.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> a - A CssTable object.

<dd> name - The name associated with the value.

<dd> format - The print format to use.

<dd> buf - A character string to hold the printed value.

<dd> buflen - The length of <b>buf</b>.

<dt> <b>Returns:</b>
<dd> 0 for success, -1 an error occurred (logErrorMsg is called)

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_replaceValue"><b>CssTable_replaceValue</b></a>
<pre>
 int CssTable_replaceValue(CssTable a,
                           const char *name,
                           const char *buf)
</pre>
<dl>
<dd>  Replace a hashtable value from a string. The CssTable's hashtable must
  already contain a value with the input name. This routine converts the
  input string to a new value of the same type for the name.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> a - A CssTable object.

<dd> name - The name of a value already stored in the hashtable.

<dd> buf - A character string representation of the new value.

<dt> <b>Returns:</b>
<dd> 0 for success, -1 an error occurred (logErrorMsg is called)

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="CssTable_readFile"><b>CssTable_readFile</b></a>
<pre>
 int CssTable_readFile(const char *file,
                       struct stat *old_stat,
                       const char *table_name,
                       Vector tables,
                       const char **err_msg)
</pre>
<dl>
<dd>  Read a file of CSS table records. This routine reads all of the CSS formatted
  records from a <b>file</b> and creates new CssTable objects. The new CssTable
  objects are returned in the Vector <b>tables</b>. If the file stat structure
  <b>old_stat</b> is not input as zeros, this routine first checks to see if
  the <b>file</b> has been modified since the last call. If the <b>file</b>
  has not been modified, it is not read. Input <b>old_stat.st_dev=0,
  old_stat.st_ino=0, old_stat.st_mtime=0</b> to force the <b>file</b> to be
  read (the first time). Repeated calls with the same <b>file</b> will only
  read if the file stat structure has changed (the file has been modifed).
  The return codes are:
  <pre>
 	 1	A successfull read. Records are returned.
 	 0	The file has not been modified. No records are returned.
 	-1	the system stat() routine failed. (<b>file</b> does not exist or cannot be accessed.
       -2	the input <b>table_name</b> has not been defined as a CssTable
 	-3	the <b>file</b> cannot be opened.
 	-4	malloc failed.
 	-5	new_CssTables failed.
 	-6	a read error occurred (e.g. a incorrectly formatted record).
  </pre>

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> file - The name of a file containing CSS formatted records.

<dd> old_stat - The a file stat structure for this file.

<dd> table_name - The CssTable type.

<dd> tables - A Vector to receive the new CssTable objects.

<dd> err_msg - *err_msg will point to a static error message, if there is  and error return.

<dt> <b>Returns:</b>
<dd> The return code.

</dl></dd>
<p>
<dd><dl>
<dt> <b>See Also:</b>
</dl></dd>
</dl>
<!Begin-Footer><hr>
<pre>
<a href="directories.html">All directories</a>  <a href="libsrc_libgobject.html">This Directory</a>  <a href="libsrc_libgobject_cssObjects.c.html#_top_">Previous</a>  <a href="libsrc_libgobject_DataLoop.c.html#_top_">Next</a>  <a href="AllNames.html">Index</a></pre>
</body>
</html>
