<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!--NewPage-->
<html>
<head>
<!-- Generated by cdoc on Wed Jan 26 05:45:09 2005 -->
<title>
file libsrc/libgresp/response.c
</title>
</head>
<body>
<a name="_top_"></a><pre>
<a href="directories.html">All directories</a>  <a href="libsrc_libgresp.html">This Directory</a>  <a href="libsrc_libgresp_get_response.c.html#_top_">Previous</a>  <a href="libsrc_libgresp_responseFiles.c.html#_top_">Next</a>  <a href="AllNames.html">Index</a></pre>
<hr>
<h1>
File libsrc/libgresp/response.c
</h1>
<hr>
<!End-Header><h2>
Public Function Index
</h2>
<dl>
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#new_Response"><b>new_Response</b></a> ()
<dd> Create a Response object.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#new_ResponseFile"><b>new_ResponseFile</b></a> (const char *)
<dd> Open a response file.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#Response_compute"><b>Response_compute</b></a> (Response, double, double, double, int, double *, double *)
<dd> Compute an intrument response curve for PAZ, FAP and FIR formats.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#Response_convolve"><b>Response_convolve</b></a> (Vector, int, float *, int, double, double, double, double, const char **)
<dd> Convolve or deconvolve instrument responses.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#Response_fap"><b>Response_fap</b></a> (Response, double, double, int, double *, double *)
<dd> Compute a frequency and amplitude response curve.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#Response_fir"><b>Response_fir</b></a> (Response, double, double, int, double *, double *)
<dd> Compute an FIR instrument response curve.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#Response_getErrMsg"><b>Response_getErrMsg</b></a> ()
<dd> Return an error message set by new_ResponseFile.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#Response_modified"><b>Response_modified</b></a> (TimeSeries)
<dd> Check if a TimeSeries has been modified by removing or adding a response.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#Response_paz"><b>Response_paz</b></a> (double, ComPlex *, int, ComPlex *, int, double, double *, double *)
<dd> Compute a poles and zeroes response.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#Response_unwrap"><b>Response_unwrap</b></a> (float *, int)
<dd> Unwrap a phase curve.
</dl>
<h2>
Public Functions
</h2>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="new_Response"><b>new_Response</b></a>
<pre>
 Response new_Response()
</pre>
<dl>
<dd>  Create a Response object. All elements are initialized to their null values.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="new_ResponseFile"><b>new_ResponseFile</b></a>
<pre>
 ResponseFile new_ResponseFile(const char *file)
</pre>
<dl>
<dd>  Open a response file. Return a ResponseFile object for a response file.
  The ResponseFile structure is (see response.h)
  typedef struct
  {
      GObjectPart     core;
 
      char            *file;      /* file name            */
      Vector          responses;  /* all responses in the file */
  } *ResponseFile;
  <pre>
  The responses Vector contains a Response object for each response in the
  file. The Response structure is
  <pre>
  typedef struct
  {
       GObjectPart core;
 
       char        source[13];     /* "theoretical" or "measured"  */
       int         seq_num;        /* sequence number              */
       char        des[13];        /* description                  */
       char        type[7];        /* fap, paz, or fir             */
       char        units[2];       /* d, v, or a                   */
       char        author[45];     /* author or information source */
       double      a0;             /* normalization for paz / gain for fir */
       int         npoles;         /* number of poles for paz type */
       int         nzeros;         /* number of zeros for paz type */
       ComPlex     *pole;          /* poles for paz type           */
       ComPlex     *pole_err;      /* poles for paz type           */
       ComPlex     *zero;          /* zeros for paz type           */
       ComPlex     *zero_err;      /* zeros for paz type           */
       int         nfap;           /* number of fap triplets       */
       float       *f;             /* frequency for fap type       */
       float       *a;             /* amplitude for fap type       */
       float       *p;             /* phase for fap type           */
       float       *a_error;       /* amplitude error for fap type */
       float       *p_error;       /* phase error for fap type     */
       float       samprate;       /* samples/sec for fir type     */
       int         num_n;          /* # numerator coeffs. for fir  */
       int         num_d;          /* # denominator coeffs. for fir*/
       float       *n;             /* numerator for fir type       */
       float       *n_error;       /* numerator error for fir type */
       float       *d;             /* denominator for fir type     */
       float       *d_error;       /* denominator error for fir    */
 
       GSE_CAL     *cal;           /* associated CAL for GSE format */
  } *Response;
  </pre>
  If an error is encountered while reading the response file, NULL is
  returned and an error message is set. Use Response_getErrMsg to retrieve
  the error message.

<p>
<dd><dl>
<dt> <b>Returns:</b>
<dd> A ResponseFile object or NULL.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="Response_compute"><b>Response_compute</b></a>
<pre>
 int Response_compute(Response resp,
                      double calper,
                      double lofreq,
                      double hifreq,
                      int nf,
                      double *real,
                      double *imag)
</pre>
<dl>
<dd>  Compute an intrument response curve for PAZ, FAP and FIR formats.
  If calper > 0., the response is normalized to one at calper.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> resp - A Response object.

<dd> calper - The calibration frequency or 0. if not used.

<dd> lofreq - The low frequency cutoff.

<dd> hifreq - The high frequency cutoff.

<dd> nf - The number of frequency value between flo and fhi to compute.

<dd> real - An array to hold the nf real response values.

<dd> imag - An array to hold the nf imaginary response values.

<dt> <b>Returns:</b>
<dd> 1 for success, 0 for failure.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="Response_convolve"><b>Response_convolve</b></a>
<pre>
 int Response_convolve(Vector resp,
                       int direction,
                       float *data,
                       int npts,
                       double dt,
                       double calper,
                       double flo,
                       double fhi,
                       const char **err_msg)
</pre>
<dl>
<dd>  Convolve or deconvolve instrument responses. Convolve or deconvolve one or
  more instrument responses with the input data array. The amplitude
  spectrum is cosine tapered from frequencies 0 to flo and from fhi to
  the nyquist frequency.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> resp - A Vector of one or more Response objects.

<dd> direction - 1: convolve, -1: deconvolve.

<dd> data - An array of float data values.

<dd> npts - The number of data values.

<dd> dt - The sample time increment.

<dd> calper - The calibration factor.

<dd> flo - The low frequence.

<dd> fhi - The high frequence.

<dd> err_msg - On error return, *err_msg is set to a static error message.

<dt> <b>Returns:</b>
<dd> 0 for success, -1 for error.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="Response_fap"><b>Response_fap</b></a>
<pre>
 int Response_fap(Response resp,
                  double lofreq,
                  double hifreq,
                  int nf,
                  double *real,
                  double *imag)
</pre>
<dl>
<dd>  Compute a frequency and amplitude response curve.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> resp - A Response object.

<dd> lofreq - The low frequency cutoff.

<dd> hifreq - The high frequency cutoff.

<dd> nf - The number of frequency value between flo and fhi to compute.

<dd> real - An array to hold the nf real response values.

<dd> imag - An array to hold the nf imaginary response values.

<dt> <b>Returns:</b>
<dd> 0 for success, -1 for error (malloc failed).

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="Response_fir"><b>Response_fir</b></a>
<pre>
 int Response_fir(Response resp,
                  double lofreq,
                  double hifreq,
                  int nf,
                  double *real,
                  double *imag)
</pre>
<dl>
<dd>  Compute an FIR instrument response curve.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> resp - A Response object.

<dd> lofreq - The low frequency cutoff.

<dd> hifreq - The high frequency cutoff.

<dd> nf - The number of frequency value between flo and fhi to compute.

<dd> real - An array to hold the nf real response values.

<dd> imag - An array to hold the nf imaginary response values.

<dt> <b>Returns:</b>
<dd> 0 for success, -1 for error (malloc failed).

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="Response_getErrMsg"><b>Response_getErrMsg</b></a>
<pre>
 const char *Response_getErrMsg()
</pre>
<dl>
<dd>  Return an error message set by new_ResponseFile.

<p>
<dd><dl>
<dt> <b>Returns:</b>
<dd> A static character string error message. (Do not free it.)

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="Response_modified"><b>Response_modified</b></a>
<pre>
 int Response_modified(TimeSeries ts)
</pre>
<dl>
<dd>  Check if a TimeSeries has been modified by removing or adding a response.
  Return 1 if the TimeSeries data has been modified by convolution or
  deconvolution with an instrument response.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> ts - A TimeSeries object.

<dt> <b>Returns:</b>
<dd> 1 if the TimeSeries has been modified, 0 if not.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="Response_paz"><b>Response_paz</b></a>
<pre>
 void Response_paz(double omega,
                   ComPlex *pole,
                   int npoles,
                   ComPlex *zero,
                   int nzeros,
                   double a0,
                   double *real,
                   double *imag)
</pre>
<dl>
<dd>  Compute a poles and zeroes response.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> omega - 
<dd> pole - 
<dd> npoles - 
<dd> zero - 
<dd> nzeros - 
<dd> a0 - 
<dd> real - 
<dd> imag - 
</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="Response_unwrap"><b>Response_unwrap</b></a>
<pre>
 void Response_unwrap(float *p,
                      int n)
</pre>
<dl>
<dd>  Unwrap a phase curve. Returns values between -PI and PI.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> p - The phase values in radians.

<dd> n - The number of phase values.

</dl></dd>
</dl>
<!Begin-Footer><hr>
<pre>
<a href="directories.html">All directories</a>  <a href="libsrc_libgresp.html">This Directory</a>  <a href="libsrc_libgresp_get_response.c.html#_top_">Previous</a>  <a href="libsrc_libgresp_responseFiles.c.html#_top_">Next</a>  <a href="AllNames.html">Index</a></pre>
</body>
</html>
