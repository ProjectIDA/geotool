<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!--NewPage-->
<html>
<head>
<!-- Generated by cdoc on Wed Jan 26 05:45:09 2005 -->
<title>
file libsrc/libmath/fft.c
</title>
</head>
<body>
<a name="_top_"></a><pre>
<a href="directories.html">All directories</a>  <a href="libsrc_libmath.html">This Directory</a>  <a href="libsrc_libmath_euler.c.html#_top_">Previous</a>  <a href="libsrc_libmath_Find.c.html#_top_">Next</a>  <a href="AllNames.html">Index</a></pre>
<hr>
<h1>
File libsrc/libmath/fft.c
</h1>
<hr>
<!End-Header> Fourier Transform routines.
<hr>
<h2>
Public Function Index
</h2>
<dl>
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#factor"><b>factor</b></a> (int)
<dd> Factor a number.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#fft"><b>fft</b></a> (float *, float *, int, int, int, int, int *)
<dd> Multivariate complex fourier tranform.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#fftl"><b>fftl</b></a> (float *, int, int)
<dd> Fourier transform.
</dl>
<h2>
Public Functions
</h2>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="factor"><b>factor</b></a>
<pre>
 int factor(int n)
</pre>
<dl>
<dd>  Factor a number.  factor determines the smallest even number >= n that
  can be factored into products of primes in the array np. The result is
  returned as factor. only the first four primes are used. This routine is
  called before using fftl.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="fft"><b>fft</b></a>
<pre>
 void fft(float *a,
          float *b,
          int ntot,
          int n,
          int nspan,
          int isn,
          int *ierr)
</pre>
<dl>
<dd>  Multivariate complex fourier tranform. The transform is computed in place
  using mixed-radix fast fourier tranform algorithm.  By R.C. Singleton,
  Stanford Research Institute, Sept. 1968.  Arrays a and b originally hold
  the real and imaginary components of the data, and return the real and
  imaginary components of the resulting fourier coefficients.  Multivariate
  data is indexed according to the fortran array element successor function,
  without limit on the number of implied muliple subscripts.  The subroutine
  is called once for each variate. The calls for a multivariate transform may
  be in any order.
  <p>
  ntot is the total number of complex data values.
  n is the dimension of the current variable.
  nspan/n is the spacing of consecutive data values while indexing the
  current variable.
  The integer ierr is an error return indicator.  It is normally zero, but
  is set to 1 if the number of terms cannot be factored in the space
  available. If it is permissible, the appropriate action at this stage is
  to enter fft again after reducing the length of the series by one term.
  The sign of isn determines the sign of the complex exponential, and the
  magnitude of isn is normally one. A tri-variate transform with
  a(n1,n2,n3), b(n1,n2,n3) is computed by
  <pre>
     call fft(a,b,n1*n2*n3,n1,n1,1)
     call fft(a,b,n1*n2*n3,n2,n1*n2,1)
     call fft(a,b,n1*n2*n3,n3,n1*n2*n3,1)
  </pre>
  For a single-variate transform,
  <pre>
     ntot = n = nspan = (number of complex data values), e.g.
     call fft(a,b,n,n,n,1)
  </pre>
  With most fortran compilers the data can alternatively be stored in a
  single complex array a, then the maginitude of isn changed to two to give
  the correct indexing increment and a[1] used to pass the initial address
  for the sequence of imaginary values, e.g.
  <pre>
     call fft(a,a+1,ntot,n,nspan,2)
  </pre>

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="fftl"><b>fftl</b></a>
<pre>
 int fftl(float *x,
          int n,
          int ndir)
</pre>
<dl>
<dd>  Fourier transform.
  If iabs(ndir)==1 fftl fourier transforms the n point real time
  series in array x. the result overwrites x stored as (n+2)/2
  complex numbers (non-negative frequencies only). if iabs(ndir)
  ==2, fftl fourier transforms the (n+2)/2 complex fourier
  coefficients (non-negative frequencies only) in array x
  (assuming the series is hermitian). the resulting n point real
  time series overwrites x.  if ndir>0 the forward transform
  uses the sign convention exp(i*w*t). if ndir <0 the forward
  transform uses the sign convention exp(-i*w*t). The forward
  transform is normalized such that a sine wave of unit amplitude
  is transformed into delta functions of unit amplitude. the 
  backward transform is the original series. ierr is normally zero.
  if ierr==1 then fftl has not been able to factor the series.
  however, x has been scrambled by realtr. note that if n is odd
  the last point will not be used in the transform.
  <p>
                                                -rpb

</dl>
<!Begin-Footer><hr>
<pre>
<a href="directories.html">All directories</a>  <a href="libsrc_libmath.html">This Directory</a>  <a href="libsrc_libmath_euler.c.html#_top_">Previous</a>  <a href="libsrc_libmath_Find.c.html#_top_">Next</a>  <a href="AllNames.html">Index</a></pre>
</body>
</html>
