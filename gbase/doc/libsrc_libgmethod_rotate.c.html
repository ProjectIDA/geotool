<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!--NewPage-->
<html>
<head>
<!-- Generated by cdoc on Wed Jan 26 05:45:09 2005 -->
<title>
file libsrc/libgmethod/rotate.c
</title>
</head>
<body>
<a name="_top_"></a><pre>
<a href="directories.html">All directories</a>  <a href="libsrc_libgmethod.html">This Directory</a>  <a href="libsrc_libgmethod_reread.c.html#_top_">Previous</a>  <a href="libsrc_libgmethod_tapers.c.html#_top_">Next</a>  <a href="AllNames.html">Index</a></pre>
<hr>
<h1>
File libsrc/libgmethod/rotate.c
</h1>
<hr>
<!End-Header><h2>
Public Function Index
</h2>
<dl>
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#new_Rotate"><b>new_Rotate</b></a> (double, TimeSeries, bool)
<dd> Create a Rotate object.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#Rotate_timeSeries"><b>Rotate_timeSeries</b></a> (TimeSeries, TimeSeries, double, int)
<dd> Rotate a pair of TimeSeries.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#Rotate_data"><b>Rotate_data</b></a> (float *, float *, int, double)
<dd> Rotate a pair of arrays.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#Rotate_max"><b>Rotate_max</b></a> (TimeSeries *, double, double, double *)
<dd> Find the rotation angle (clockwise) which maximizes the y-component.
</dl>
<h2>
Public Functions
</h2>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="new_Rotate"><b>new_Rotate</b></a>
<pre>
 Rotate new_Rotate(double angle,
                   TimeSeries mate,
                   bool mate_is_x)
</pre>
<dl>
<dd>   Create a Rotate object. Rotate applies a rotation two horizontal components.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> angle - The rotation angle.

<dd> mate - The other horizontal component.

<dd> mate_is_x - True if mate is the East-West component.

<dt> <b>Returns:</b>
<dd> a Rotate object, or NULL if malloc fails (logErrorMsg will be called)

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="Rotate_timeSeries"><b>Rotate_timeSeries</b></a>
<pre>
 void Rotate_timeSeries(TimeSeries ts1,
                        TimeSeries ts2,
                        double angle,
                        int update)
</pre>
<dl>
<dd>  Rotate a pair of TimeSeries. Either one or both of the input TimeSeries
  can be altered.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> ts1 - The East-West component TimeSeries.

<dd> ts2 - The North-South component TimeSeries.

<dd> angle - The rotation angle in degrees clockwise.

<dd> update - 1 alter ts1, 2 alter ts2, 3 alter both ts1 and ts2

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="Rotate_data"><b>Rotate_data</b></a>
<pre>
 void Rotate_data(float *x,
                  float *y,
                  int npts,
                  double angle)
</pre>
<dl>
<dd>  Rotate a pair of arrays.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> x - The East-West component.

<dd> y - The North-South component.

<dd> angle - The rotation angle in degrees clockwise.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="Rotate_max"><b>Rotate_max</b></a>
<pre>
 int Rotate_max(TimeSeries *ts,
                double tmin,
                double tmax,
                double *max_theta)
</pre>
<dl>
<dd>  Find the rotation angle (clockwise) which maximizes the y-component.
  If x' and y' are the rotated coordinates, then
  <pre>
  	x'[i] = cos(theta)*x[i] - sin(theta)*y[i];
  	y'[i] = sin(theta)*x[i] + cos(theta)*y[i];
 
 	maximize { sum( y'[i] * y'[i] ) - sum(x'[i] * x'[i]) }
 
 	x'*x' = cos*cos*x*x + sin*sin*y*y - 2*sin*cos*x*y
 	y'*y' = sin*sin*x*x + cos*cos*y*y + 2*sin*cos*x*y
 
 	y'*y' - x'*x' = cos(2*theta)*(y*y-x*x) + 2*sin(2*theta)*x*y
 
 	partial derivative = -2*sin(2*theta)*(y*y-x*x) + 4*cos(2*theta)*x*y = 0
 
 		tan(2*theta) = 2*sum(x[i]*y[i])/sum(y[i]*y[i]-x[i]*x[i])
 
 	max_theta = .5*atan2(2*sum(x[i]*y[i]), sum(y[i]*y[i]-x[i]*x[i]))
  </pre>

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> ts - Array of two TimeSeries objects, ordered ts[0]=East and  ts[1]=North.

<dd> tmin - The beginning time of the data window to process.

<dd> tmax - The ending time of the data window to process.

</dl></dd>
</dl>
<!Begin-Footer><hr>
<pre>
<a href="directories.html">All directories</a>  <a href="libsrc_libgmethod.html">This Directory</a>  <a href="libsrc_libgmethod_reread.c.html#_top_">Previous</a>  <a href="libsrc_libgmethod_tapers.c.html#_top_">Next</a>  <a href="AllNames.html">Index</a></pre>
</body>
</html>
