<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!--NewPage-->
<html>
<head>
<!-- Generated by cdoc on Wed Jan 26 05:45:09 2005 -->
<title>
file libsrc/libgobject/TimeSeries.c
</title>
</head>
<body>
<a name="_top_"></a><pre>
<a href="directories.html">All directories</a>  <a href="libsrc_libgobject.html">This Directory</a>  <a href="libsrc_libgobject_sp.c.html#_top_">Previous</a>  <a href="libsrc_libgobject_Vector.c.html#_top_">Next</a>  <a href="AllNames.html">Index</a></pre>
<hr>
<h1>
File libsrc/libgobject/TimeSeries.c
</h1>
<hr>
<!End-Header>This class represents a time series. The time series can have data gaps and   a variable time increment. Data is stored in an array of non-overlapping
   Segment objects.
  <pre>
  typedef struct
  {
 	GObjectPart	core;
 
      	int		npts;           * total number of samples *
      	Segment         *s;             * array of Segment structures *
      	int             size;           * number of Segment structures *
      	double          tdel_tolerance;
          tdel_tolerance determines if adjacent segments will be joined.
          If the percent change in tdel is < tdel_tolerance and
          the percent change in the gap between segments is < tdel_tolerance,
          two adjacent segments will be combined into one segment.
 	double		calib_tolerance;
          calib_tolerance determines if adjacent segments will be joined.
          If the percent change in calib is < calib_tolerance,
          two adjacent segments will be combined into one segment.
  
 	Hashtable       hashtable;      * Hashtable object *
  } *TimeSeries;
  </pre>
 
<p>
<dd><dl>
<dt> <b>See Also:</b>
</dl></dd>
<hr>
<h2>
Public Function Index
</h2>
<dl>
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#new_TimeSeries"><b>new_TimeSeries</b></a> ()
<dd> Construct an empty TimeSeries.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#new_TimeSeries_sl"><b>new_TimeSeries_sl</b></a> (Segment *, int)
<dd> Construct a TimeSeries from an array of Segments.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#new_TimeSeries_s"><b>new_TimeSeries_s</b></a> (Segment)
<dd> Construct a TimeSeries with a single Segment.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#TimeSeries_addSegment"><b>TimeSeries_addSegment</b></a> (TimeSeries, Segment)
<dd> Add a Segment to this TimeSeries.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#TimeSeries_addSegmentJoin"><b>TimeSeries_addSegmentJoin</b></a> (TimeSeries, Segment, bool)
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#TimeSeries_fillAllGaps"><b>TimeSeries_fillAllGaps</b></a> (TimeSeries, int)
<dd> Fill all data gaps that are <= maxGap sample intervals.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#TimeSeries_fillGap"><b>TimeSeries_fillGap</b></a> (TimeSeries, int, int)
<dd> Fill a data gap.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#TimeSeries_splineSegments"><b>TimeSeries_splineSegments</b></a> (TimeSeries, double, int)
<dd> Fill a data gap using a cubic spline interpolation.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#TimeSeries_join"><b>TimeSeries_join</b></a> (TimeSeries, TimeSeries)
<dd> Combine this TimeSeries with another one.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#TimeSeries_clone"><b>TimeSeries_clone</b></a> (GObject)
<dd> Clone this TimeSeries.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#TimeSeries_continuous"><b>TimeSeries_continuous</b></a> (TimeSeries, int, double, double)
<dd> Returns true if the i'th Segment of this TimeSeries is
   continuous with the i-1 Segment.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#TimeSeries_copyInto"><b>TimeSeries_copyInto</b></a> (TimeSeries, float *)
<dd> Copies the data from this TimeSeries into an array.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#TimeSeries_dataMax"><b>TimeSeries_dataMax</b></a> (TimeSeries)
<dd> Returns the maximum data value.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#TimeSeries_dataMin"><b>TimeSeries_dataMin</b></a> (TimeSeries)
<dd> Returns the minimum data value.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#TimeSeries_lowerBound"><b>TimeSeries_lowerBound</b></a> (TimeSeries, double)
<dd> Returns the DataPoint lower bound to time.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#TimeSeries_mean"><b>TimeSeries_mean</b></a> (TimeSeries)
<dd> Returns the arithmetic mean of the data in this TimeSeries.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#TimeSeries_nearest"><b>TimeSeries_nearest</b></a> (TimeSeries, double)
<dd> Returns the nearest DataPoint to time.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#TimeSeries_segment"><b>TimeSeries_segment</b></a> (TimeSeries, double)
<dd> Returns the segment containing a time point.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#TimeSeries_nearestSegment"><b>TimeSeries_nearestSegment</b></a> (TimeSeries, double)
<dd> Returns the segment containing a time point.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#TimeSeries_subseries"><b>TimeSeries_subseries</b></a> (TimeSeries, double, double)
<dd> Creates a new TimeSeries from this TimeSeries including only data
   between times t1 and t2.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#TimeSeries_truncate"><b>TimeSeries_truncate</b></a> (TimeSeries, double, double)
<dd> Truncates both ends a TimeSeries.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#TimeSeries_upperBound"><b>TimeSeries_upperBound</b></a> (TimeSeries, double)
<dd> Returns the DataPoint upper bound to time.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#TimeSeries_setData"><b>TimeSeries_setData</b></a> (TimeSeries, float *)
<dd> Replace the data of this TimeSeries with the data[] array.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#TimeSeries_removeAllSegments"><b>TimeSeries_removeAllSegments</b></a> (TimeSeries)
<dd> Remove all Segments from a TimeSeries.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#TimeSeries_setData_t"><b>TimeSeries_setData_t</b></a> (TimeSeries, TimeSeries)
<dd> Replace the data of this TimeSeries with the data of another TimeSeries.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#TimeSeries_setHashtable"><b>TimeSeries_setHashtable</b></a> (TimeSeries, Hashtable)
<dd> Set the Hashtable in a TimeSeries.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#TimeSeries_getSegment"><b>TimeSeries_getSegment</b></a> (TimeSeries, int)
<dd> Returns the Segment containing the data at the specified index,
   counting from the beginning of the time series.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#TimeSeries_time"><b>TimeSeries_time</b></a> (TimeSeries, int)
<dd> Returns the time corresponding to the index of a data point.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#TimeSeries_flagged_arrays"><b>TimeSeries_flagged_arrays</b></a> (TimeSeries, DataPoint, DataPoint, float **, float **)
<dd> Return an array of data values.
</dl>
<h2>
Public Functions
</h2>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="new_TimeSeries"><b>new_TimeSeries</b></a>
<pre>
 TimeSeries new_TimeSeries()
</pre>
<dl>
<dd>  Construct an empty TimeSeries.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="new_TimeSeries_sl"><b>new_TimeSeries_sl</b></a>
<pre>
 TimeSeries new_TimeSeries_sl(Segment *s,
                              int s_length)
</pre>
<dl>
<dd>   Construct a TimeSeries from an array of Segments. Calls method
   addSegment() for each element of the Segment array.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="new_TimeSeries_s"><b>new_TimeSeries_s</b></a>
<pre>
 TimeSeries new_TimeSeries_s(Segment s)
</pre>
<dl>
<dd>   Construct a TimeSeries with a single Segment. Calls method
   addSegment() to add the segment.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="TimeSeries_addSegment"><b>TimeSeries_addSegment</b></a>
<pre>
 void TimeSeries_addSegment(TimeSeries ts,
                            Segment newSeg)
</pre>
<dl>
<dd>   Add a Segment to this TimeSeries. The Segment added can have
   any beginning time and any length. If it overlaps Segments already
   in the TimeSeries, overlapped data values from Segments already in
   the TimeSeries are discarded or replaced by data values from the
   new Segment.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="TimeSeries_addSegmentJoin"><b>TimeSeries_addSegmentJoin</b></a>
<pre>
 void TimeSeries_addSegmentJoin(TimeSeries ts,
                                Segment newSeg,
                                bool join)
</pre>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="TimeSeries_fillAllGaps"><b>TimeSeries_fillAllGaps</b></a>
<pre>
 void TimeSeries_fillAllGaps(TimeSeries ts,
                             int maxGap)
</pre>
<dl>
<dd>   Fill all data gaps that are <= maxGap sample intervals. Gaps are filled
   by cubic spline interpolation. A gap will not be filled if the
   change in sample intervals between segments exceeds the tdel_tolerance.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="TimeSeries_fillGap"><b>TimeSeries_fillGap</b></a>
<pre>
 void TimeSeries_fillGap(TimeSeries ts,
                         int segment_index,
                         int maxGap)
</pre>
<dl>
<dd>   Fill a data gap. Fill the gap before a segment if it is <= maxGap
   sample intervals. The gap is filled by cubic spline interpolation.
   The gap will not be filled if the change in sample intervals between
   segments exceeds the tdel_tolerance.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="TimeSeries_splineSegments"><b>TimeSeries_splineSegments</b></a>
<pre>
 void TimeSeries_splineSegments(TimeSeries ts,
                                double maxDtChange,
                                int maxGap)
</pre>
<dl>
<dd>  Fill a data gap using a cubic spline interpolation.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="TimeSeries_join"><b>TimeSeries_join</b></a>
<pre>
 void TimeSeries_join(TimeSeries ts,
                      TimeSeries t)
</pre>
<dl>
<dd>   Combine this TimeSeries with another one. The TimeSeries can be
   in any order and can overlap.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="TimeSeries_clone"><b>TimeSeries_clone</b></a>
<pre>
 GObject TimeSeries_clone(GObject o)
</pre>
<dl>
<dd>   Clone this TimeSeries. Creates a new TimeSeries from the Segments in
   this TimeSeries.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="TimeSeries_continuous"><b>TimeSeries_continuous</b></a>
<pre>
 bool TimeSeries_continuous(TimeSeries ts,
                            int i,
                            double tbegTol,
                            double tdelTol)
</pre>
<dl>
<dd>   Returns true if the i'th Segment of this TimeSeries is
   continuous with the i-1 Segment. Returns false otherwise.
   The first Segment is 0. Returns false for i = 0.
   A Segment is continuous with the previous Segment, if the
   shift in tbeg < tbegTol and the shift in tdel is < tdelTol.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> i - The Segment index. Begins at 0.

<dd> tbegTol - Tolerance for shifted tbeg.

<dd> tdelTol - Tolerance for shifted tdel.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="TimeSeries_copyInto"><b>TimeSeries_copyInto</b></a>
<pre>
 void TimeSeries_copyInto(TimeSeries ts,
                          float *data)
</pre>
<dl>
<dd>   Copies the data from this TimeSeries into an array.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="TimeSeries_dataMax"><b>TimeSeries_dataMax</b></a>
<pre>
 double TimeSeries_dataMax(TimeSeries ts)
</pre>
<dl>
<dd>   Returns the maximum data value.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="TimeSeries_dataMin"><b>TimeSeries_dataMin</b></a>
<pre>
 double TimeSeries_dataMin(TimeSeries ts)
</pre>
<dl>
<dd>   Returns the minimum data value.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="TimeSeries_lowerBound"><b>TimeSeries_lowerBound</b></a>
<pre>
 DataPoint TimeSeries_lowerBound(TimeSeries ts,
                                 double time)
</pre>
<dl>
<dd>   Returns the DataPoint lower bound to time.
   Returns the first DataPoint if time < tbeg.
   Returns the last DataPoint if time > tend.

<p>
<p>
<dd><dl>
<dt> <b>See Also:</b>
</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="TimeSeries_mean"><b>TimeSeries_mean</b></a>
<pre>
 double TimeSeries_mean(TimeSeries ts)
</pre>
<dl>
<dd>   Returns the arithmetic mean of the data in this TimeSeries.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="TimeSeries_nearest"><b>TimeSeries_nearest</b></a>
<pre>
 DataPoint TimeSeries_nearest(TimeSeries ts,
                              double time)
</pre>
<dl>
<dd>   Returns the nearest DataPoint to time. Returns null if this
   TimeSeries contains no data values.

<p>
<p>
<dd><dl>
<dt> <b>See Also:</b>
</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="TimeSeries_segment"><b>TimeSeries_segment</b></a>
<pre>
 Segment TimeSeries_segment(TimeSeries ts,
                            double time)
</pre>
<dl>
<dd>   Returns the segment containing a time point. Returns null if
   no segment contains the time.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="TimeSeries_nearestSegment"><b>TimeSeries_nearestSegment</b></a>
<pre>
 Segment TimeSeries_nearestSegment(TimeSeries ts,
                                   double time)
</pre>
<dl>
<dd>   Returns the segment containing a time point. If no segment contains the
   time, returns the nearest segment.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="TimeSeries_subseries"><b>TimeSeries_subseries</b></a>
<pre>
 TimeSeries TimeSeries_subseries(TimeSeries ts,
                                 double t1,
                                 double t2)
</pre>
<dl>
<dd>   Creates a new TimeSeries from this TimeSeries including only data
   between times t1 and t2.

<p>
<dd><dl>
<dt> <b>Returns:</b>
<dd> New TimeSeries with samples between time t1 to time t2. Returns  NULL, if t1 > t2 or t1 >= tend(ts) or t2 < tbeg(ts) or no samples  are between t1 and t2.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="TimeSeries_truncate"><b>TimeSeries_truncate</b></a>
<pre>
 bool TimeSeries_truncate(TimeSeries ts,
                          double t1,
                          double t2)
</pre>
<dl>
<dd>   Truncates both ends a TimeSeries. Saves data between times t1 and t2.
   Returns true if any segments were truncated. Returns false when:
   t1 > t2 or t1 >= tend <BR>
   t2 < tbeg <BR>
   No data times t are in the window t1 <= t <= t2.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="TimeSeries_upperBound"><b>TimeSeries_upperBound</b></a>
<pre>
 DataPoint TimeSeries_upperBound(TimeSeries ts,
                                 double time)
</pre>
<dl>
<dd>   Returns the DataPoint upper bound to time.
   Returns the last DataPoint if time > tend.
   Returns the first DataPoint if time < tbeg.

<p>
<p>
<dd><dl>
<dt> <b>See Also:</b>
</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="TimeSeries_setData"><b>TimeSeries_setData</b></a>
<pre>
 void TimeSeries_setData(TimeSeries ts,
                         float *data)
</pre>
<dl>
<dd>   Replace the data of this TimeSeries with the data[] array.
   The length of this TimeSeries remains the same, regardless of
   the length of data[].

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="TimeSeries_removeAllSegments"><b>TimeSeries_removeAllSegments</b></a>
<pre>
 void TimeSeries_removeAllSegments(TimeSeries ts)
</pre>
<dl>
<dd>  Remove all Segments from a TimeSeries.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="TimeSeries_setData_t"><b>TimeSeries_setData_t</b></a>
<pre>
 void TimeSeries_setData_t(TimeSeries ts,
                           TimeSeries t)
</pre>
<dl>
<dd>   Replace the data of this TimeSeries with the data of another TimeSeries.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="TimeSeries_setHashtable"><b>TimeSeries_setHashtable</b></a>
<pre>
 void TimeSeries_setHashtable(TimeSeries ts,
                              Hashtable h)
</pre>
<dl>
<dd>  Set the Hashtable in a TimeSeries.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="TimeSeries_getSegment"><b>TimeSeries_getSegment</b></a>
<pre>
 Segment TimeSeries_getSegment(TimeSeries ts,
                               int index)
</pre>
<dl>
<dd>   Returns the Segment containing the data at the specified index,
   counting from the beginning of the time series. Returns NULL,
   if index < 0 or index >= ts->npts.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="TimeSeries_time"><b>TimeSeries_time</b></a>
<pre>
 double TimeSeries_time(TimeSeries ts,
                        int index)
</pre>
<dl>
<dd>   Returns the time corresponding to the index of a data point.
   if index < 0 or index >= ts->npts, the time is computed using the first
   or last segment tdel.

</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="TimeSeries_flagged_arrays"><b>TimeSeries_flagged_arrays</b></a>
<pre>
 int TimeSeries_flagged_arrays(TimeSeries ts,
                               DataPoint d1,
                               DataPoint d2,
                               float **pt,
                               float **py)
</pre>
<dl>
<dd>  Return an array of data values. Return an array of data values between
  DataPoints <b>d1</b> and <b>d2</b>. At data gaps, insert an NAN value.

</dl>
<!Begin-Footer><hr>
<pre>
<a href="directories.html">All directories</a>  <a href="libsrc_libgobject.html">This Directory</a>  <a href="libsrc_libgobject_sp.c.html#_top_">Previous</a>  <a href="libsrc_libgobject_Vector.c.html#_top_">Next</a>  <a href="AllNames.html">Index</a></pre>
</body>
</html>
