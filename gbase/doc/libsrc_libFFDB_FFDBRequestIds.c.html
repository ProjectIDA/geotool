<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!--NewPage-->
<html>
<head>
<!-- Generated by cdoc on Wed Jan 26 05:45:09 2005 -->
<title>
file libsrc/libFFDB/FFDBRequestIds.c
</title>
</head>
<body>
<a name="_top_"></a><pre>
<a href="directories.html">All directories</a>  <a href="libsrc_libFFDB.html">This Directory</a>  <a href="libsrc_libFFDB_FFDBQueryTable.c.html#_top_">Previous</a>  <a href="libsrc_libFFDB_FFDBStatic.c.html#_top_">Next</a>  <a href="AllNames.html">Index</a></pre>
<hr>
<h1>
File libsrc/libFFDB/FFDBRequestIds.c
</h1>
<hr>
<!End-Header> Routines to request ids from the lastid table.
<hr>
<h2>
Public Function Index
</h2>
<dl>
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#FFDBGetNextId"><b>FFDBGetNextId</b></a> (FFDatabase, const char *, const char *)
<dd> Get an id (keyvalue) from the lastid table and increment it.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#FFDBNumberIDsAvailable"><b>FFDBNumberIDsAvailable</b></a> (const char *)
<dd> Get the number of recycled ids available.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#FFDBRecycleIds"><b>FFDBRecycleIds</b></a> (const char *, int *, int)
<dd> Recycle ids from the lastid table.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#FFDBRequestIds"><b>FFDBRequestIds</b></a> (FFDatabase, const char *, const char *, int, int, int *, int *)
<dd> Request one or more ids from the lastid table.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#FFDBSetRequestIdIncrement"><b>FFDBSetRequestIdIncrement</b></a> (const char *, int)
<dd> Set the lastid request increment for keyname.
 <dt> <img src="red_ball_small.gif" width=6 height=6 alt=" o ">
      <a href="#FFDBUpdateLastid"><b>FFDBUpdateLastid</b></a> (FFDatabase, const char *, const char *, int, int *)
<dd> Update the lastid table.
</dl>
<h2>
Public Functions
</h2>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="FFDBGetNextId"><b>FFDBGetNextId</b></a>
<pre>
 int FFDBGetNextId(FFDatabase ffdb,
                   const char *tableName,
                   const char *keyname)
</pre>
<dl>
<dd>  Get an id (keyvalue) from the lastid table and increment it. The id is taken
  from the recycled-id-list, if available. Otherwise, the keyvalue of the
  lastid record corresponding to the <b>tableName</b> and <b>keyname</b> is
  returned and increased by the <b>idIncrement</b> value. The
  <b>idIncrement</b> defaults to 1 for all keynames. Use
  FFDBSetRequestIdIncrement to set the <b>idIncrement</b>.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> ffdb - An FFDatabase pointer from FFDBOpen().

<dd> tableName - The name of the lastid table including the account,  if necessary.

<dd> keyname - The lastid keyname ("arid", "orid", etc.).

<dt> <b>Returns:</b>
<dd> The keyvalue (next id) or -1 for failure. Retrieve the error number  and error message with FFDBErrno() and FFDBErrMsg().

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="FFDBNumberIDsAvailable"><b>FFDBNumberIDsAvailable</b></a>
<pre>
 int FFDBNumberIDsAvailable(const char *keyname)
</pre>
<dl>
<dd>  Get the number of recycled ids available. For the input keyname, return the
  number of ids in the recycled-id-list.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> keyname - The lastid keyname ("arid", "orid", etc.).

<dt> <b>Returns:</b>
<dd> The number of ids in the recycled-id-list.

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="FFDBRecycleIds"><b>FFDBRecycleIds</b></a>
<pre>
 int FFDBRecycleIds(const char *keyname,
                    int *ids,
                    int numReturned)
</pre>
<dl>
<dd>  Recycle ids from the lastid table. Give ids to the recycle list to be used
  by FFDBGetNextId and FFDBRequestIds.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> keyname - The lastid keyname ("arid", "orid", etc.).

<dd> ids - An array of ids.

<dd> numReturned - The number <b>ids</b> to put in the recycle list.

<dt> <b>Returns:</b>
<dd> 0 for success, -1 if malloc fails. Retrieve the error number  and error message with FFDBErrno() and FFDBErrMsg().

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="FFDBRequestIds"><b>FFDBRequestIds</b></a>
<pre>
 int FFDBRequestIds(FFDatabase ffdb,
                    const char *tableName,
                    const char *keyname,
                    int numRequested,
                    int consecutive,
                    int *ids,
                    int *numReturned)
</pre>
<dl>
<dd>  Request one or more ids from the lastid table. The requested number of
  ids are taken from the recycled-id-list, if available. If necessary,
  ids are taken from the lastid table. The keyvalue of the lastid table
  is incremented by the larger of the number of ids needed or the
  <b>idIncrement</b>.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> ffdb - An FFDatabase pointer from FFDBOpen().

<dd> tableName - The name of the lastid table including the account,  if necessary.

<dd> keyname - The lastid keyname ("arid", "orid", etc.).

<dd> numRequested - The number of ids requested.

<dd> consecutive - Set to 1 to request consecutive ids. Set to 0 to request  any available ids.

<dd> ids - An array to hold the returned <b>numRequested</b> ids.

<dd> numReturned - The actual number of ids returned in <b>ids</b>.

<dt> <b>Returns:</b>
<dd> 0 for success, -1 for failure. Retrieve the error number  and error message with FFDBErrno() and FFDBErrMsg().

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="FFDBSetRequestIdIncrement"><b>FFDBSetRequestIdIncrement</b></a>
<pre>
 int FFDBSetRequestIdIncrement(const char *keyname,
                               int idIncrement)
</pre>
<dl>
<dd>  Set the lastid request increment for keyname. For the input keyname, set
  the minimum number of ids that will actually be requested from the lastid
  table each time a request is made with FFDBGetNextId or FFDBRequestIds.
  Extra ids are saved in the recycle list.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> keyname - The keyname of the lastid record ("arid", "orid", etc.).

<dd> increment - The minimum number of ids to request from the database.

<dt> <b>Returns:</b>
<dd> 0 for success, -1 if increment <= 0 or malloc fails. Retrieve the  error number and error message with FFDBErrno() and FFDBErrMsg().

</dl></dd>
</dl>
<img src="red_ball.gif" width=12 height=12 alt= " o ">
<a name="FFDBUpdateLastid"><b>FFDBUpdateLastid</b></a>
<pre>
 int FFDBUpdateLastid(FFDatabase ffdb,
                      const char *tableName,
                      const char *keyname,
                      int numRequested,
                      int *keyvalue)
</pre>
<dl>
<dd>  Update the lastid table. The keyvalue of the lastid table is returned in
  <b>keyvalue</b> and incremented by <b>numRequested</b>.

<p>
<dd><dl>
<dt> <b>Parameters:</b>
<dd> ffdb - An FFDatabase pointer from FFDBOpen().

<dd> tableName - The name of the lastid table including account if necessary.

<dd> keyname - The lastid keyname ("arid", "orid", etc.).

<dd> numRequested - The number of ids requested.

<dt> <b>Returns:</b>
<dd> 0 for success, -1 for error. Retrieve the error number  and error message with FFDBErrno() and FFDBErrMsg().

</dl></dd>
</dl>
<!Begin-Footer><hr>
<pre>
<a href="directories.html">All directories</a>  <a href="libsrc_libFFDB.html">This Directory</a>  <a href="libsrc_libFFDB_FFDBQueryTable.c.html#_top_">Previous</a>  <a href="libsrc_libFFDB_FFDBStatic.c.html#_top_">Next</a>  <a href="AllNames.html">Index</a></pre>
</body>
</html>
